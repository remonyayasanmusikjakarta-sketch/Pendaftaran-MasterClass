<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pendaftaran MasterClass - Mr. Guiseppe Fausto Mudugno</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- ==================== CSS START (DESAIN LEBIH TERANG) ==================== -->
    <style>
        :root {
            --primary-color: #333333;
            --secondary-color: #c9a961; /* Warna Emas yang lebih lembut */
            --text-color: #555555;
            --bg-color: #f8f5f0; /* Background Krem */
            --light-bg-color: #ffffff;
            --border-color: #e0d9c9;
            --font-heading: 'Playfair Display', serif;
            --font-body: 'Lato', sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 40px auto;
            padding: 40px 50px;
            background-color: var(--light-bg-color);
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border-radius: 8px;
            position: relative;
            z-index: 10;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 20px;
        }

        .language-selector {
            position: absolute;
            top: 15px;
            right: 20px;
        }

        .language-selector select {
            background-color: var(--light-bg-color);
            color: var(--primary-color);
            border: 1px solid var(--border-color);
            padding: 5px 10px;
            border-radius: 4px;
            font-family: var(--font-body);
        }

        h1 {
            font-family: var(--font-heading);
            font-size: 3.5rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .subtitle {
            font-family: var(--font-heading);
            font-size: 1.8rem;
            font-weight: 400;
            color: var(--text-color);
            margin-bottom: 10px;
        }

        .organizer {
            font-style: italic;
            color: #777;
        }

        main h3 {
            font-family: var(--font-heading);
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }

        .details {
            background-color: #fdfcfb;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }

        .details p {
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: var(--primary-color);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            background-color: var(--light-bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-color);
            font-family: var(--font-body);
            font-size: 1rem;
        }

        .radio-group, .checkbox-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .radio-group label, .checkbox-group label {
            font-weight: 400;
            cursor: pointer;
            color: var(--text-color);
        }

        .price-display {
            text-align: center;
            font-size: 1.5rem;
            font-family: var(--font-heading);
            color: var(--light-bg-color);
            margin: 20px 0;
            padding: 15px;
            background-color: var(--secondary-color);
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .price-display.visible {
            opacity: 1;
        }

        .bank-info {
            background-color: #fdfcfb;
            border: 1px dashed var(--secondary-color);
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background-color: var(--secondary-color);
            color: var(--light-bg-color);
            border: none;
            border-radius: 5px;
            font-size: 1.2rem;
            font-weight: 700;
            font-family: var(--font-body);
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .submit-btn:hover {
            background-color: #b39a55;
            transform: translateY(-2px);
        }

        .music-notes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .note {
            position: absolute;
            font-size: 2.5rem;
            color: rgba(201, 169, 97, 0.15); /* Disesuaikan dengan tema baru */
            animation-name: float-up;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }

        .note-1 { left: 10%; animation-duration: 15s; animation-delay: 0s; }
        .note-2 { left: 50%; animation-duration: 18s; animation-delay: 2s; }
        .note-3 { left: 80%; animation-duration: 20s; animation-delay: 5s; }

        @keyframes float-up {
            from { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.4; }
            90% { opacity: 0.4; }
            to { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        .violin {
            position: absolute;
            bottom: 50px;
            right: -150px;
            width: 300px;
            height: 100px;
            background: url('https://i.imgur.com/k1w9b3e.png') no-repeat center center;
            background-size: contain;
            opacity: 0.08; /* Disesuaikan dengan tema baru */
            animation: violin-slide 25s linear infinite;
        }

        @keyframes violin-slide {
            from { transform: translateX(0); }
            to { transform: translateX(calc(-100vw - 300px)); }
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9rem;
            color: #888;
        }

        @media (max-width: 768px) {
            .container { margin: 20px auto; padding: 20px; }
            h1 { font-size: 2.5rem; }
            .subtitle { font-size: 1.4rem; }
            .radio-group, .checkbox-group { flex-direction: column; gap: 10px; }
        }
    </style>
    <!-- ===================== CSS END ===================== -->
</head>
<body>

    <div class="container">
        <header>
            <div class="language-selector">
                <select id="languageSelect">
                    <option value="id">Bahasa Indonesia</option>
                    <option value="en">English</option>
                    <option value="zh">简体中文</option>
                </select>
            </div>
            <h1 data-lang-id="Pendaftaran MasterClass" data-lang-en="MasterClass Registration" data-lang-zh="大师课注册">Pendaftaran MasterClass</h1>
            <h2 class="subtitle">dengan Mr. Guiseppe Fausto Mudugno</h2>
            <p class="organizer" data-lang-id="Diselenggarakan oleh: Yayasan Musik Jakarta" data-lang-en="Organized by: Yayasan Musik Jakarta" data-lang-zh="主办方：雅加达音乐基金会">Diselenggarakan oleh: Yayasan Musik Jakarta</p>
        </header>

        <main>
            <section class="details">
                <p><strong data-lang-id="Pembicara" data-lang-en="Speaker" data-lang-zh="讲师">Pembicara:</strong> Director, Conservatorio "Vechi-Tonelli", Modena, Italy</p>
                <p><strong data-lang-id="Lokasi" data-lang-en="Venue" data-lang-zh="地点">Lokasi:</strong> YMJ BSD Auditorium, Jl. Letnan Soetopo, BSD</p>
                <p><strong data-lang-id="Kontak" data-lang-en="Contact" data-lang-zh="联系">Kontak:</strong> +62 811-9892-413</p>
            </section>

            <form id="registrationForm">
                <h3 data-lang-id="Formulir Pendaftaran" data-lang-en="Registration Form" data-lang-zh="注册表单">Formulir Pendaftaran</h3>
                
                <div class="form-group">
                    <label for="nama" data-lang-id="Nama Lengkap" data-lang-en="Full Name" data-lang-zh="全名">Nama Lengkap</label>
                    <input type="text" id="nama" name="nama" required>
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="noHp" data-lang-id="No. HP / WhatsApp" data-lang-en="Phone / WhatsApp" data-lang-zh="手机号/WhatsApp">No. HP / WhatsApp</label>
                    <input type="tel" id="noHp" name="noHp" required>
                </div>

                <div class="form-group">
                    <label for="asalSekolah" data-lang-id="Asal Sekolah / Institusi" data-lang-en="School / Institution" data-lang-zh="学校/机构">Asal Sekolah / Institusi</label>
                    <input type="text" id="asalSekolah" name="asalSekolah" required>
                </div>
                
                <div class="form-group">
                    <label for="tingkat" data-lang-id="Tingkat Pendidikan" data-lang-en="Education Level" data-lang-zh="教育水平">Tingkat Pendidikan</label>
                    <select id="tingkat" name="tingkat" required>
                        <option value="" data-lang-id="-- Pilih --" data-lang-en="-- Choose --" data-lang-zh="-- 选择 --">-- Pilih --</option>
                        <option value="SD" data-lang-id="SD / Sederajat" data-lang-en="Elementary" data-lang-zh="小学">SD / Sederajat</option>
                        <option value="SMP" data-lang-id="SMP / Sederajat" data-lang-en="Junior High" data-lang-zh="初中">SMP / Sederajat</option>
                        <option value="SMA" data-lang-id="SMA / SMK / Sederajat" data-lang-en="Senior High / Vocational" data-lang-zh="高中/职高">SMA / SMK / Sederajat</option>
                        <option value="Mahasiswa" data-lang-id="Mahasiswa" data-lang-en="University Student" data-lang-zh="大学生">Mahasiswa</option>
                        <option value="Profesional" data-lang-id="Profesional / Guru" data-lang-en="Professional / Teacher" data-lang-zh="专业人士/教师">Profesional / Guru</option>
                        <option value="Lainnya" data-lang-id="Lainnya" data-lang-en="Other" data-lang-zh="其他">Lainnya</option>
                    </select>
                </div>

                <div class="form-group">
                    <label data-lang-id="Kategori Partisipasi" data-lang-en="Participation Category" data-lang-zh="参与类别">Kategori Partisipasi</label>
                    <div class="radio-group">
                        <label><input type="radio" name="participationType" value="passive" required> <span data-lang-id="Peserta Pasif (Observasi)" data-lang-en="Passive Participant (Observation)" data-lang-zh="被动参与者 (观摩)">Peserta Pasif (Observasi)</span></label>
                        <label><input type="radio" name="participationType" value="active" required> <span data-lang-id="Peserta Aktif" data-lang-en="Active Participant" data-lang-zh="主动参与者">Peserta Aktif</span></label>
                    </div>
                </div>
                
                <div class="form-group" id="ymjStatusGroup" style="display:none;">
                    <label data-lang-id="Status Keanggotaan YMJ" data-lang-en="YMJ Membership Status" data-lang-zh="YMJ 会员状态">Status Keanggotaan YMJ</label>
                    <div class="radio-group" id="ymjStatusOptions">
                        <!-- Options will be populated by JS -->
                    </div>
                </div>

                <div id="priceDisplay" class="price-display">
                    <!-- Price will be shown here -->
                </div>

                <div id="bankInfo" class="bank-info" style="display:none;">
                    <p data-lang-id="Silakan lakukan pembayaran ke:" data-lang-en="Please make the payment to:" data-lang-zh="请付款至以下账户：">Silakan lakukan pembayaran ke:</p>
                    <p><strong>BANK BCA</strong></p>
                    <p>No. Rek: <strong>5880182244</strong></p>
                    <p>a/n: <strong>Yayasan Musik Jakarta</strong></p>
                </div>

                <div class="form-group" id="dateReservationGroup">
                    <label data-lang-id="Pilih Tanggal Reservasi" data-lang-en="Select Reservation Date" data-lang-zh="选择预订日期">Pilih Tanggal Reservasi</label>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="tanggal" value="23"> 23</label>
                        <label><input type="checkbox" name="tanggal" value="24"> 24</label>
                    </div>
                </div>
                
                <div class="form-group" id="paymentProofGroup" style="display: none;">
                    <label for="paymentProof" data-lang-id="Unggah Bukti Pembayaran" data-lang-en="Upload Payment Proof" data-lang-zh="上传付款凭证">Unggah Bukti Pembayaran</label>
                    <input type="file" id="paymentProof" name="paymentProof" accept="image/*,.pdf">
                </div>

                <button type="submit" class="submit-btn" data-lang-id="Kirim Pendaftaran" data-lang-en="Submit Registration" data-lang-zh="提交注册">Kirim Pendaftaran</button>
            </form>
        </main>
        
        <footer>
            <p>&copy; 2024 Yayasan Musik Jakarta. All Rights Reserved.</p>
        </footer>
    </div>

    <!-- Animated Music Notes -->
    <div class="music-notes">
        <div class="note note-1">♪</div>
        <div class="note note-2">♫</div>
        <div class="note note-3">♬</div>
        <div class="violin"></div>
    </div>

    <!-- =================== JAVASCRIPT START (LOGIKA DIPERBAIKI) =================== -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- PENTING: GANTI DENGAN URL WEB APP ANDA ---
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwoTuoa3b7iys9exKuGU82S3XatsH3nwJfcPmxVQfGQRNRBopw82u0AQSCWxstR0u0ePw/exec';

        const languageSelect = document.getElementById('languageSelect');
        const form = document.getElementById('registrationForm');
        const participationRadios = document.querySelectorAll('input[name="participationType"]');
        const ymjStatusGroup = document.getElementById('ymjStatusGroup');
        const ymjStatusOptions = document.getElementById('ymjStatusOptions');
        const priceDisplay = document.getElementById('priceDisplay');
        const bankInfo = document.getElementById('bankInfo');
        const paymentProofGroup = document.getElementById('paymentProofGroup');
        const paymentProofInput = document.getElementById('paymentProof');

        const translations = {
            id: {
                passive: { ymj: 'Guru/Siswa YMJ', non: 'Non-YMJ' },
                active: { ymj_teacher: 'Guru YMJ', ymj_student: 'Siswa YMJ', non: 'Non-YMJ' },
                prices: { 'passive-ymj': 'GRATIS', 'passive-non': 'IDR 50.000', 'active-ymj_teacher': 'IDR 100.000', 'active-ymj_student': 'IDR 500.000', 'active-non': 'IDR 650.000' },
                success: 'Pendaftaran Anda berhasil terkirim!', error: 'Terjadi kesalahan. Silakan coba lagi.', noDate: 'Anda harus memilih setidaknya satu tanggal.', noFile: 'Anda harus mengunggah bukti pembayaran.'
            },
            en: {
                passive: { ymj: 'YMJ Teacher/Student', non: 'Non-YMJ' },
                active: { ymj_teacher: 'YMJ Teacher', ymj_student: 'YMJ Student', non: 'Non-YMJ' },
                prices: { 'passive-ymj': 'FREE', 'passive-non': 'IDR 50,000', 'active-ymj_teacher': 'IDR 100,000', 'active-ymj_student': 'IDR 500,000', 'active-non': 'IDR 650,000' },
                success: 'Your registration has been submitted successfully!', error: 'An error occurred. Please try again.', noDate: 'You must select at least one date.', noFile: 'You must upload a payment proof.'
            },
            zh: {
                passive: { ymj: 'YMJ 教师/学生', non: '非 YMJ' },
                active: { ymj_teacher: 'YMJ 教师', ymj_student: 'YMJ 学生', non: '非 YMJ' },
                prices: { 'passive-ymj': '免费', 'passive-non': '50,000 印尼盾', 'active-ymj_teacher': '100,000 印尼盾', 'active-ymj_student': '500,000 印尼盾', 'active-non': '650,000 印尼盾' },
                success: '您的注册已成功提交！', error: '发生错误。请重试。', noDate: '您必须至少选择一个日期。', noFile: '您必须上传付款凭证。'
            }
        };

        let currentLang = 'id';

        function switchLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('[data-lang-' + lang + ']').forEach(element => {
                element.innerText = element.getAttribute('data-lang-' + lang);
            });
            updatePriceAndForm(); // Re-render display with new language
        }
        
        // --- PERBAIKAN LOGIKA: Pisahkan fungsi untuk generate opsi dan update harga ---
        function generateYmjOptions(participationType) {
            let optionsHtml = '';
            if (participationType === 'passive') {
                optionsHtml = `<label><input type="radio" name="ymjStatus" value="ymj" required> <span>${translations[currentLang].passive.ymj}</span></label>
                               <label><input type="radio" name="ymjStatus" value="non" required> <span>${translations[currentLang].passive.non}</span></label>`;
            } else { // active
                optionsHtml = `<label><input type="radio" name="ymjStatus" value="ymj_teacher" required> <span>${translations[currentLang].active.ymj_teacher}</span></label>
                               <label><input type="radio" name="ymjStatus" value="ymj_student" required> <span>${translations[currentLang].active.ymj_student}</span></label>
                               <label><input type="radio" name="ymjStatus" value="non" required> <span>${translations[currentLang].active.non}</span></label>`;
            }
            ymjStatusOptions.innerHTML = optionsHtml;
        }

        function updatePriceDisplay() {
            const participationType = document.querySelector('input[name="participationType"]:checked')?.value;
            const ymjStatus = document.querySelector('input[name="ymjStatus"]:checked')?.value;

            if (!participationType || !ymjStatus) {
                priceDisplay.classList.remove('visible');
                bankInfo.style.display = 'none';
                paymentProofGroup.style.display = 'none';
                paymentProofInput.required = false;
                return;
            }

            const priceKey = `${participationType}-${ymjStatus}`;
            const price = translations[currentLang].prices[priceKey];
            const categoryText = ymjStatusOptions.querySelector(`input[value="${ymjStatus}"] + span`).innerText;
            
            priceDisplay.innerHTML = `<strong>${categoryText}</strong><br>Biaya: ${price}`;
            priceDisplay.classList.add('visible');

            if (price !== translations[currentLang].prices['passive-ymj']) {
                bankInfo.style.display = 'block';
                paymentProofGroup.style.display = 'block';
                paymentProofInput.required = true;
            } else {
                bankInfo.style.display = 'none';
                paymentProofGroup.style.display = 'none';
                paymentProofInput.required = false;
            }
        }

        function updatePriceAndForm() {
            const participationType = document.querySelector('input[name="participationType"]:checked')?.value;
            
            if (!participationType) {
                ymjStatusGroup.style.display = 'none';
                updatePriceDisplay(); // Hide everything
                return;
            }
            
            ymjStatusGroup.style.display = 'block';
            generateYmjOptions(participationType);
            updatePriceDisplay(); // Update display based on the new options
        }
        
        // Event Listeners
        languageSelect.addEventListener('change', (e) => switchLanguage(e.target.value));

        participationRadios.forEach(radio => { 
            radio.addEventListener('change', updatePriceAndForm); 
        });

        // *** PERBAIKAN AKHIR: Gunakan Event Delegation yang benar ***
        form.addEventListener('change', function(e) {
            if (e.target.matches('input[name="ymjStatus"]')) {
                updatePriceDisplay(); // Hanya update harga, jangan generate ulang HTML
            }
        });

        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            const dates = Array.from(document.querySelectorAll('input[name="tanggal"]:checked')).map(cb => cb.value);
            if (dates.length === 0) { alert(translations[currentLang].noDate); return; }
            const isPaymentRequired = paymentProofInput.required;
            if (isPaymentRequired && !paymentProofInput.files.length) { alert(translations[currentLang].noFile); return; }
            
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            data.tanggalReservasi = dates.join(', ');
            
            const categoryText = priceDisplay.querySelector('strong').innerText;
            const priceText = priceDisplay.innerText.split('Biaya: ')[1];
            data.kategori = categoryText;
            data.biaya = priceText;

            if (paymentProofInput.files.length > 0) {
                const file = paymentProofInput.files[0];
                data.paymentProofName = file.name;
                data.paymentProofMime = file.type;
                data.paymentProofBase64 = await toBase64(file);
            }

            try {
                form.querySelector('.submit-btn').disabled = true;
                const originalBtnText = form.querySelector('.submit-btn').innerText;
                form.querySelector('.submit-btn').innerText = 'Mengirim...';
                
                const response = await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                const result = await response.json();
                
                if (result.status === 'success') {
                    alert(translations[currentLang].success);
                    form.reset();
                    updatePriceAndForm(); // Reset form view
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                console.error(error);
                alert(translations[currentLang].error + '\n' + error.message);
            } finally {
                form.querySelector('.submit-btn').disabled = false;
                form.querySelector('.submit-btn').innerText = originalBtnText;
            }
        });

        function toBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }
    });
    </script>
    <!-- ==================== JAVASCRIPT END ==================== -->
</body>
</html>

